/*! carebot-tracker - v0.5.0 - 2016-03-03 */
!function(a,c,d){var e={fields:[],percentOnScreen:"50%",reportInterval:10,googleAnalytics:!1,callback:function(){}};a.screentime=function(f){function g(b){this.selector=b.selector,$elem=this.$elem=a(b.selector),this.name=b.name,this.top=$elem.offset().top,this.height=$elem.height(),this.bottom=this.top+this.height,this.width=$elem.width()}function h(){var b=a(c);this.top=b.scrollTop(),this.height=b.height(),this.bottom=this.top+this.height,this.width=b.width()}function i(a,b){p&&ga("send","event","Screentime","Time on Screen",a,parseInt(b,10),{nonInteraction:!0}),q&&_gaq.push(["_trackEvent","Screentime","Time on Screen",a,parseInt(b,10),!0])}function j(a,b){var c,d,e;return b.bottom<=a.bottom&&b.top>=a.top?!0:b.height>a.height&&(c=a.bottom-b.top>a.height/2&&b.bottom-a.top>a.height/2)?!0:(d=b.height*(f.percentOnScreen/100),e=a.bottom-d>=b.top&&b.bottom-d>a.top)}function k(){var b=new h;a.each(s,function(a,c){j(b,c)&&(t[a]+=1,r[a]+=1)})}function l(){var b={};a.each(r,function(a,c){c>0&&(b[a]=c,r[a]=0,f.googleAnalytics&&i(a,c))}),a.isEmptyObject(b)||f.callback.call(this,b,t)}function m(){v||(k(),v=!0),u=setInterval(function(){k()},1e3),reporter=setInterval(function(){l()},1e3*f.reportInterval)}function n(){clearInterval(u),clearInterval(reporter)}function o(){a.each(f.fields,function(b,c){if(a(c.selector).length){var d=new g(c);s[d.name]=d,r[d.name]=0,t[d.name]=0}}),m(),visibly.onHidden(function(){n()}),visibly.onVisible(function(){n(),m()})}f=a.extend({},e,f),f.percentOnScreen=parseInt(f.percentOnScreen.replace("%",""),10);var p,q,r={},s={},t={},u=null,v=!1;f.fields.length&&(f.googleAnalytics&&("function"==typeof ga&&(p=!0),"undefined"!=typeof _gaq&&"function"==typeof _gaq.push&&(q=!0)),function(){c.visibly={q:d,p:void 0,prefixes:["webkit","ms","o","moz","khtml"],props:["VisibilityState","visibilitychange","Hidden"],m:["focus","blur"],visibleCallbacks:[],hiddenCallbacks:[],genericCallbacks:[],_callbacks:[],cachedPrefix:"",fn:null,onVisible:function(a){"function"==typeof a&&this.visibleCallbacks.push(a)},onHidden:function(a){"function"==typeof a&&this.hiddenCallbacks.push(a)},getPrefix:function(){if(!this.cachedPrefix)for(var a=0;b=this.prefixes[a++];)if(b+this.props[2]in this.q)return this.cachedPrefix=b,this.cachedPrefix},visibilityState:function(){return this._getProp(0)},hidden:function(){return this._getProp(2)},visibilitychange:function(a){"function"==typeof a&&this.genericCallbacks.push(a);var b=this.genericCallbacks.length;if(b)if(this.cachedPrefix)for(;b--;)this.genericCallbacks[b].call(this,this.visibilityState());else for(;b--;)this.genericCallbacks[b].call(this,arguments[0])},isSupported:function(a){return this.cachedPrefix+this.props[2]in this.q},_getProp:function(a){return this.q[this.cachedPrefix+this.props[a]]},_execute:function(a){if(a){this._callbacks=1==a?this.visibleCallbacks:this.hiddenCallbacks;for(var b=this._callbacks.length;b--;)this._callbacks[b]()}},_visible:function(){c.visibly._execute(1),c.visibly.visibilitychange.call(c.visibly,"visible")},_hidden:function(){c.visibly._execute(2),c.visibly.visibilitychange.call(c.visibly,"hidden")},_nativeSwitch:function(){this[this._getProp(2)?"_hidden":"_visible"]()},_listen:function(){try{this.isSupported()?this.q.addEventListener(this.cachedPrefix+this.props[1],function(){c.visibly._nativeSwitch.apply(c.visibly,arguments)},1):this.q.addEventListener?(c.addEventListener(this.m[0],this._visible,1),c.addEventListener(this.m[1],this._hidden,1)):this.q.attachEvent&&(this.q.attachEvent("onfocusin",this._visible),this.q.attachEvent("onfocusout",this._hidden))}catch(a){}},init:function(){this.getPrefix(),this._listen()}},this.visibly.init()}(),a.screentime.reset=function(){n(),a.each(s,function(a,b){t[a]=0,r[a]=0}),m()},o())}}(jQuery,window,document),function(a){"function"==typeof define&&define.amd?define(a):"undefined"!=typeof module&&module.exports?module.exports=a():window.CarebotTracker=a.call(this)}(function(){var a={};return a.Timer=function(a){function b(a){var b,c;if(60>a){var d=10*Math.floor(a/10);c=d.toString()+"s"}else if(a>=60&&300>a)b=Math.floor(a/60),c=b.toString()+"m";else{b=Math.floor(a/60);var e=5*Math.floor(b/5);c=e.toString()+"m"}return c}function c(a){if(!a)return 0;var b=new Date,c=Math.abs(b-a),d=Math.floor(c/1e3);return d}function d(a){var d=c(a)+m,e=b(d);return{bucket:e,seconds:d}}function e(){return d(i)}function f(){var b=d(i);if(b.bucket!==j){if(b.seconds>=l)return;a(b),j=b.bucket}}function g(){i=new Date,a&&(k=setInterval(f,1e4))}function h(){m=c(i)+m,clearInterval(k),i=void 0}var i,j,k,l=1201,m=0;return{start:g,pause:h,check:e}}.bind(this),a.VisibilityTracker=function(b,c,d){function e(a){var b=a.getBoundingClientRect(),c=window.innerWidth||document.documentElement.clientWidth,d=window.innerHeight||document.documentElement.clientHeight,e=b.left<0,f=b.right>c,g=b.bottom>d,h=b.top<0;return e||f||h||g?!1:!0}function f(){var a=e(j);return k&&!a&&l.pause(),!k&&a&&l.start(),k=a,a}function g(){h&&window.clearTimeout(h),h=window.setTimeout(f,i)}var h,i=50,j=document.getElementById(b),k=!1,l=new a.Timer(c);d=d||{},window.addEventListener?(addEventListener("DOMContentLoaded",g,!1),addEventListener("load",g,!1),addEventListener("scroll",g,!1),addEventListener("resize",g,!1)):window.attachEvent&&(attachEvent("onDOMContentLoaded",g),attachEvent("onload",g),attachEvent("onscroll",g),attachEvent("onresize",g)),f()},a.ScrollTracker=function(a,b,c){function d(){var a,b,c=document.body,d=document.documentElement;return window.hasOwnProperty("pageYOffset")?(a=window.pageYOffset,b=window.pageXOffset):d.hasOwnProperty("scrollTop")?(a=d.scrollTop,b=d.scrollLeft):(a=c.scrollTop,b=c.scrollLeft),{scrollTop:a,scrollLeft:b}}function e(a){var b=a.getBoundingClientRect(),c=document.body,e=document.documentElement,f=d(),g=f.scrollTop,h=f.scrollLeft;window.hasOwnProperty("pageYOffset")?(g=window.pageYOffset,h=window.pageXOffset):e.hasOwnProperty("scrollTop")?(g=e.scrollTop,h=e.scrollLeft):(g=c.scrollTop,h=c.scrollLeft);var i=e.clientTop||c.clientTop||0,j=e.clientLeft||c.clientLeft||0,k=b.top+g-i,l=b.left+h-j;return{top:Math.round(k),left:Math.round(l)}}function f(){var a=e(k).top,b=k.offsetHeight,c=d().scrollTop,f=c+window.innerHeight,g=(f-a)/b;return g}function g(a){return 10*Math.round(10*a)}function h(){var a=f(),c=g(a);c>l&&(l=c,b(c))}var i,j=100,k=document.getElementById(a),l=0;window.addEventListener("scroll",function(a){i&&window.clearTimeout(i),i=window.setTimeout(h,j)})},a});